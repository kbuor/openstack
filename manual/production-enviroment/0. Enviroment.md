# RUN ON CONTROLLER
## PREPARE OS
---
```shell
hostnamectl set-hostname controller01.openstack.local
```
```shell
apt update -y & apt upgrade -y
```
```shell
reboot
```
## INSTALL DATABASES
---
1. Install SQL Database
```shell
apt install chrony -y
```
```shell
root@controller:~# apt install -y chrony
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following packages will be REMOVED:
  systemd-timesyncd
The following NEW packages will be installed:
  chrony
0 upgraded, 1 newly installed, 1 to remove and 0 not upgraded.
Need to get 290 kB of archives.
After this operation, 360 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 chrony amd64 4.2-2ubuntu2 [290 kB]
Fetched 290 kB in 2s (144 kB/s)                     
(Reading database ... 94061 files and directories currently installed.)
Removing systemd-timesyncd (249.11-0ubuntu3.12) ...
Selecting previously unselected package chrony.
(Reading database ... 94047 files and directories currently installed.)
Preparing to unpack .../chrony_4.2-2ubuntu2_amd64.deb ...
Unpacking chrony (4.2-2ubuntu2) ...
Setting up chrony (4.2-2ubuntu2) ...

Creating config file /etc/chrony/chrony.conf with new version

Creating config file /etc/chrony/chrony.keys with new version
dpkg-statoverride: warning: --update given but /var/log/chrony does not exist
Created symlink /etc/systemd/system/chronyd.service → /lib/systemd/system/chrony.service.
Created symlink /etc/systemd/system/multi-user.target.wants/chrony.service → /lib/systemd/system/chrony.service.
Processing triggers for dbus (1.12.20-2ubuntu4.1) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...                                                                                                                                         
Scanning linux images...                                                                                                                                      

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```

2. Edit the **chrony.conf** file and add, change, or remove the following keys as necessary for your environment.
```shell
vi /etc/chrony/chrony.conf
```
```shell
confdir /etc/chrony/conf.d
sourcedir /run/chrony-dhcp
sourcedir /etc/chrony/sources.d
keyfile /etc/chrony/chrony.keys
driftfile /var/lib/chrony/chrony.drift
ntsdumpdir /var/lib/chrony
logdir /var/log/chrony
maxupdateskew 100.0
rtcsync
makestep 1 3
leapsectz right/UTC
server 0.vn.pool.ntp.org iburst
allow 10.0.0.0/24
```

3. Restart the NTP service:
```shell
systemctl enable chrony
systemctl start chrony
```
```shell
root@controller:~# systemctl start chrony
root@controller:~# systemctl enable chrony
Synchronizing state of chrony.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable chrony
```

4. Verify NTP service:
```shell
chronyc sources
```
```shell
root@controller:~# chronyc sources
MS Name/IP address         Stratum Poll Reach LastRx Last sample               
===============================================================================
^* 103.188.82.179                2   6    17     2    +35us[  +78us] +/-   17ms
```

### Other Node
1. Install the packages.
```shell
apt install -y chrony
```
```shell
root@compute1:~# apt install -y chrony
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following packages will be REMOVED:
  systemd-timesyncd
The following NEW packages will be installed:
  chrony
0 upgraded, 1 newly installed, 1 to remove and 0 not upgraded.
Need to get 290 kB of archives.
After this operation, 360 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 chrony amd64 4.2-2ubuntu2 [290 kB]
Fetched 290 kB in 1s (206 kB/s)  
(Reading database ... 94061 files and directories currently installed.)
Removing systemd-timesyncd (249.11-0ubuntu3.12) ...
Selecting previously unselected package chrony.
(Reading database ... 94047 files and directories currently installed.)
Preparing to unpack .../chrony_4.2-2ubuntu2_amd64.deb ...
Unpacking chrony (4.2-2ubuntu2) ...
Setting up chrony (4.2-2ubuntu2) ...

Creating config file /etc/chrony/chrony.conf with new version

Creating config file /etc/chrony/chrony.keys with new version
dpkg-statoverride: warning: --update given but /var/log/chrony does not exist
Created symlink /etc/systemd/system/chronyd.service → /lib/systemd/system/chrony.service.
Created symlink /etc/systemd/system/multi-user.target.wants/chrony.service → /lib/systemd/system/chrony.service.
Processing triggers for dbus (1.12.20-2ubuntu4.1) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...                                                                                                                                         
Scanning linux images...                                                                                                                                      

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
2. Configure the **chrony.conf** file and comment out or remove all but one server key. Change it to reference the controller node.
```shell
vi /etc/chrony/chrony.conf
```
```shell
confdir /etc/chrony/conf.d
sourcedir /run/chrony-dhcp
sourcedir /etc/chrony/sources.d
keyfile /etc/chrony/chrony.keys
driftfile /var/lib/chrony/chrony.drift
ntsdumpdir /var/lib/chrony
logdir /var/log/chrony
maxupdateskew 100.0
rtcsync
makestep 1 3
leapsectz right/UTC
server controller iburst
```
3. Start service
```shell
systemctl restart chrony
systemctl enable chrony
```
```shell
root@compute1:~# systemctl restart chrony
root@compute1:~# systemctl enable chrony
Synchronizing state of chrony.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable chrony
```
4. Verify NTP service:
```shell
chronyc sources
```
```shell
root@compute1:~# chronyc sources
MS Name/IP address         Stratum Poll Reach LastRx Last sample               
===============================================================================
^* controller                    3   6    17    54  +9868ns[  +13us] +/-   18ms
```

# OpenStack packages
### Controller Node
1. OpenStack 2024.1 Caracal for Ubuntu 22.04 LTS:
```shell
add-apt-repository cloud-archive:caracal
```
```shell
root@controller:~# add-apt-repository cloud-archive:caracal
Repository: 'deb http://ubuntu-cloud.archive.canonical.com/ubuntu jammy-updates/caracal main'
Description:
Ubuntu Cloud Archive for OpenStack Caracal
More info: https://wiki.ubuntu.com/OpenStack/CloudArchive
Adding repository.
Press [ENTER] to continue or Ctrl-c to cancel.
Adding deb entry to /etc/apt/sources.list.d/cloudarchive-caracal.list
Adding disabled deb-src entry to /etc/apt/sources.list.d/cloudarchive-caracal.list
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  ubuntu-cloud-keyring
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 4564 B of archives.
After this operation, 20.5 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 ubuntu-cloud-keyring all 2021.03.26 [4564 B]
Fetched 4564 B in 0s (9835 B/s)                
Selecting previously unselected package ubuntu-cloud-keyring.
(Reading database ... 94104 files and directories currently installed.)
Preparing to unpack .../ubuntu-cloud-keyring_2021.03.26_all.deb ...
Unpacking ubuntu-cloud-keyring (2021.03.26) ...
Setting up ubuntu-cloud-keyring (2021.03.26) ...
Scanning processes...                                                                                                                                         
Scanning linux images...                                                                                                                                      

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
Hit:1 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:2 http://security.ubuntu.com/ubuntu jammy-security InRelease           
Hit:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease             
Hit:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease                            
Get:5 http://ubuntu-cloud.archive.canonical.com/ubuntu jammy-updates/caracal InRelease [7778 B]
Get:6 http://ubuntu-cloud.archive.canonical.com/ubuntu jammy-updates/caracal/main amd64 Packages [213 kB]
Fetched 221 kB in 2s (110 kB/s)   
Reading package lists... Done
```
2. Verify
```shell
apt install nova-compute python3-openstackclient -y
```
```shell
root@controller:~# apt install nova-compute python3-openstackclient -y
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  acl adwaita-icon-theme alembic alsa-topology-conf alsa-ucm-conf at-spi2-core bridge-utils bzip2 cpu-checker dconf-gsettings-backend dconf-service dns-root-data dnsmasq-base
  docutils-common ebtables fontconfig fontconfig-config fonts-dejavu-core genisoimage glib-networking glib-networking-common glib-networking-services gsettings-desktop-schemas
  gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-x gtk-update-icon-cache hicolor-icon-theme humanity-icon-theme ibverbs-providers ieee-data ipxe-qemu
  ipxe-qemu-256k-compat-efi-roms javascript-common jq keystone-common libaa1 libasound2 libasound2-data libasyncns0 libatk-bridge2.0-0 libatk1.0-0 libatk1.0-data libatspi2.0-0
  libavahi-client3 libavahi-common-data libavahi-common3 libavc1394-0 libblas3 libbpf1 libbrlapi0.8 libcaca0 libcacard0 libcairo-gobject2 libcairo2 libcdparanoia0 libcolord2 libcups2
  libdatrie1 libdaxctl1 libdconf1 libdecor-0-0 libdecor-0-plugin-1-cairo libdeflate0 libdrm-amdgpu1 libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libdv4 libepoxy0 libevent-2.1-7 libfdt1
  libflac8 libfontconfig1 libgbm1 libgdk-pixbuf-2.0-0 libgdk-pixbuf2.0-bin libgdk-pixbuf2.0-common libgfapi0 libgfortran5 libgfrpc0 libgfxdr0 libgl1 libgl1-amber-dri libgl1-mesa-dri
  libglapi-mesa libglusterfs0 libglvnd0 libglx-mesa0 libglx0 libgomp1 libgraphite2-3 libgstreamer-plugins-base1.0-0 libgstreamer-plugins-good1.0-0 libgtk-3-0 libgtk-3-bin libgtk-3-common
  libharfbuzz0b libibverbs1 libiec61883-0 libimagequant0 libiscsi7 libjack-jackd2-0 libjbig0 libjpeg-turbo8 libjpeg8 libjq1 libjs-jquery libjs-sphinxdoc libjs-underscore liblapack3
  liblcms2-2 libllvm15 libmp3lame0 libmpg123-0 libndctl6 libnl-route-3-200 libnss-mymachines libogg0 libonig5 libopenjp2-7 libopus0 liborc-0.4-0 libpango-1.0-0 libpangocairo-1.0-0
  libpangoft2-1.0-0 libpaper-utils libpaper1 libpciaccess0 libpcsclite1 libpixman-1-0 libpmem1 libpmemobj1 libproxy1v5 libpulse0 libquadmath0 librados2 libraqm0 libraw1394-11 librbd1
  librdmacm1 librsvg2-2 librsvg2-common libsamplerate0 libsdl2-2.0-0 libsensors-config libsensors5 libshout3 libslirp0 libsndfile1 libsoup2.4-1 libsoup2.4-common libspeex1
  libspice-server1 libtag1v5 libtag1v5-vanilla libthai-data libthai0 libtheora0 libtiff5 libtpms0 libtwolame0 libunbound8 liburing2 libusbredirparser1 libv4l-0 libv4lconvert0
  libvirglrenderer1 libvirt-clients libvirt-daemon libvirt-daemon-config-network libvirt-daemon-config-nwfilter libvirt-daemon-driver-qemu libvirt-daemon-system
  libvirt-daemon-system-systemd libvirt0 libvisual-0.4-0 libvorbis0a libvorbisenc2 libvpx7 libvte-2.91-0 libvte-2.91-common libwavpack1 libwayland-client0 libwayland-cursor0
  libwayland-egl1 libwayland-server0 libwebp7 libwebpdemux2 libwebpmux3 libx11-xcb1 libxcb-dri2-0 libxcb-dri3-0 libxcb-glx0 libxcb-present0 libxcb-randr0 libxcb-render0 libxcb-shm0
  libxcb-sync1 libxcb-xfixes0 libxcomposite1 libxcursor1 libxdamage1 libxdp1 libxfixes3 libxi6 libxinerama1 libxkbcommon0 libxml2-utils libxrandr2 libxrender1 libxshmfence1 libxss1
  libxtst6 libxv1 libxxf86vm1 libyajl2 lsscsi mailcap mdevctl mime-support msr-tools nova-common nova-compute-kvm nova-compute-libvirt nvme-cli os-brick-common ovmf pycadf-common
  python-pastedeploy-tpl python3-alembic python3-amqp python3-aniso8601 python3-anyjson python3-appdirs python3-asgiref python3-autopage python3-barbicanclient python3-blinker python3-bs4
  python3-cachetools python3-castellan python3-cffi python3-cinderclient python3-click python3-cliff python3-cmd2 python3-cursive python3-dateutil python3-ddt python3-debtcollector
  python3-decorator python3-defusedxml python3-deprecation python3-dnspython python3-docutils python3-dogpile.cache python3-elementpath python3-eventlet python3-extras python3-fasteners
  python3-fixtures python3-flask python3-flask-restful python3-futurist python3-glanceclient python3-greenlet python3-html5lib python3-importlib-resources python3-iso8601
  python3-itsdangerous python3-jmespath python3-jsonschema python3-keystone python3-keystoneauth1 python3-keystoneclient python3-keystonemiddleware python3-kombu python3-ldap
  python3-libvirt python3-lxml python3-mako python3-memcache python3-microversion-parse python3-migrate python3-monotonic python3-msgpack python3-munch python3-nacl python3-netaddr
  python3-neutronclient python3-nova python3-novaclient python3-numpy python3-olefile python3-openstacksdk python3-openvswitch python3-os-brick python3-os-client-config
  python3-os-resource-classes python3-os-service-types python3-os-traits python3-os-vif python3-os-win python3-osc-lib python3-osc-placement python3-oslo.cache python3-oslo.concurrency
  python3-oslo.config python3-oslo.context python3-oslo.db python3-oslo.i18n python3-oslo.limit python3-oslo.log python3-oslo.messaging python3-oslo.metrics python3-oslo.middleware
  python3-oslo.policy python3-oslo.privsep python3-oslo.reports python3-oslo.rootwrap python3-oslo.serialization python3-oslo.service python3-oslo.upgradecheck python3-oslo.utils
  python3-oslo.versionedobjects python3-oslo.vmware python3-osprofiler python3-ovsdbapp python3-paramiko python3-passlib python3-paste python3-pastedeploy python3-pastescript python3-pbr
  python3-pil python3-platformdirs python3-ply python3-prettytable python3-prometheus-client python3-psutil python3-pycadf python3-pycparser python3-pygments python3-pyinotify
  python3-pymemcache python3-pymysql python3-pyperclip python3-pyroute2 python3-pysaml2 python3-repoze.lru python3-requestsexceptions python3-retrying python3-rfc3986 python3-roman
  python3-routes python3-scrypt python3-simplejson python3-sortedcontainers python3-soupsieve python3-sqlalchemy python3-sqlalchemy-ext python3-sqlparse python3-statsd python3-stevedore
  python3-suds python3-tempita python3-tenacity python3-testresources python3-testscenarios python3-testtools python3-tooz python3-typing-extensions python3-unittest2 python3-vine
  python3-voluptuous python3-warlock python3-wcwidth python3-webencodings python3-webob python3-websockify python3-werkzeug python3-wrapt python3-xmlschema python3-zvmcloudconnector
  qemu-block-extra qemu-system-common qemu-system-data qemu-system-gui qemu-system-x86 qemu-utils seabios session-migration sgml-base swtpm swtpm-tools systemd-container ubuntu-mono
  x11-common xml-core xmlsec1 zvmcloudconnector-common
Suggested packages:
  ifupdown bzip2-doc wodim cdrkit-doc gvfs apache2 | lighttpd | httpd libasound2-plugins alsa-utils colord cups-common libdv-bin oss-compat libvisual-0.4-plugins jackd2 liblcms2-utils
  opus-tools pcscd pulseaudio libraw1394-doc librsvg2-bin xdg-utils lm-sensors speex gstreamer1.0-libav gstreamer1.0-plugins-ugly libvirt-login-shell libvirt-daemon-driver-storage-gluster
  libvirt-daemon-driver-storage-iscsi-direct libvirt-daemon-driver-storage-rbd libvirt-daemon-driver-storage-zfs libvirt-daemon-driver-lxc libvirt-daemon-driver-vbox
  libvirt-daemon-driver-xen numad auditd nfs-common pm-utils systemtap zfsutils guestmount sysfsutils python-amqp-doc python-blinker-doc python-castellan-doc python3-dev python-cliff-doc
  python-cursive-doc python-debtcollector-doc python3-trio python3-h2 python3-httpx python3-httpcore docutils-doc fonts-linuxlibertine | ttf-linux-libertine texlive-lang-french
  texlive-latex-base texlive-latex-recommended python-eventlet-doc python3-dotenv python-flask-doc python-futurist-doc python-glanceclient-doc python-greenlet-dev python-greenlet-doc
  python3-genshi python-jsonschema-doc python3-rfc3987 python3-uritemplate python3-webcolors python3-ldappool python-keystoneauth1-doc python3-requests-kerberos python-kombu-doc
  python3-boto python3-django python3-pymongo python3-redis python-lxml-doc python3-beaker python-mako-doc memcached python-microversion-parse-doc python-migrate-doc python-nacl-doc
  ipython3 python-netaddr-docs gcc gfortran python-numpy-doc python3-pytest python-openstacksdk-doc python-os-brick-doc python-os-client-config-doc python-os-service-types-doc
  python-os-traits-doc python-os-vif-doc python-os-win-doc python-osc-lib-doc python-osc-placement-doc python3-binary-memcached python-oslo.cache-doc python-oslo.concurrency-doc
  python-oslo.log-doc python3-confluent-kafka python3-zmq python-oslo.middleware-doc python-oslo.policy-doc python-oslo.privsep-doc python-oslo.reports-doc python-oslo.service-doc
  python-oslo.versionedobjects-doc python-ovsdbapp-doc python3-gssapi python3-invoke httpd-wsgi libapache2-mod-python libapache2-mod-scgi libjs-mochikit python3-cherrypy3 python-pil-doc
  python-ply-doc python-psutil-doc cpp python-pygments-doc ttf-bitstream-vera python-pyinotify-doc python-pymysql-doc python3-repoze.who python-sortedcontainers-doc python-sqlalchemy-doc
  python3-fdb python3-pymssql python3-mysqldb python3-psycopg2 python3-asyncpg python3-aiosqlite python-sqlparse-doc python-tenacity-doc python-testtools-doc python3-etcd3gw python3-kazoo
  python3-sysv-ipc python3-zake python-webob-doc python-werkzeug-doc python3-watchdog samba vde2 debootstrap sgml-base-doc trousers debhelper
The following NEW packages will be installed:
  acl adwaita-icon-theme alembic alsa-topology-conf alsa-ucm-conf at-spi2-core bridge-utils bzip2 cpu-checker dconf-gsettings-backend dconf-service dns-root-data dnsmasq-base
  docutils-common ebtables fontconfig fontconfig-config fonts-dejavu-core genisoimage glib-networking glib-networking-common glib-networking-services gsettings-desktop-schemas
  gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-x gtk-update-icon-cache hicolor-icon-theme humanity-icon-theme ibverbs-providers ieee-data ipxe-qemu
  ipxe-qemu-256k-compat-efi-roms javascript-common jq keystone-common libaa1 libasound2 libasound2-data libasyncns0 libatk-bridge2.0-0 libatk1.0-0 libatk1.0-data libatspi2.0-0
  libavahi-client3 libavahi-common-data libavahi-common3 libavc1394-0 libblas3 libbpf1 libbrlapi0.8 libcaca0 libcacard0 libcairo-gobject2 libcairo2 libcdparanoia0 libcolord2 libcups2
  libdatrie1 libdaxctl1 libdconf1 libdecor-0-0 libdecor-0-plugin-1-cairo libdeflate0 libdrm-amdgpu1 libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libdv4 libepoxy0 libevent-2.1-7 libfdt1
  libflac8 libfontconfig1 libgbm1 libgdk-pixbuf-2.0-0 libgdk-pixbuf2.0-bin libgdk-pixbuf2.0-common libgfapi0 libgfortran5 libgfrpc0 libgfxdr0 libgl1 libgl1-amber-dri libgl1-mesa-dri
  libglapi-mesa libglusterfs0 libglvnd0 libglx-mesa0 libglx0 libgomp1 libgraphite2-3 libgstreamer-plugins-base1.0-0 libgstreamer-plugins-good1.0-0 libgtk-3-0 libgtk-3-bin libgtk-3-common
  libharfbuzz0b libibverbs1 libiec61883-0 libimagequant0 libiscsi7 libjack-jackd2-0 libjbig0 libjpeg-turbo8 libjpeg8 libjq1 libjs-jquery libjs-sphinxdoc libjs-underscore liblapack3
  liblcms2-2 libllvm15 libmp3lame0 libmpg123-0 libndctl6 libnl-route-3-200 libnss-mymachines libogg0 libonig5 libopenjp2-7 libopus0 liborc-0.4-0 libpango-1.0-0 libpangocairo-1.0-0
  libpangoft2-1.0-0 libpaper-utils libpaper1 libpciaccess0 libpcsclite1 libpixman-1-0 libpmem1 libpmemobj1 libproxy1v5 libpulse0 libquadmath0 librados2 libraqm0 libraw1394-11 librbd1
  librdmacm1 librsvg2-2 librsvg2-common libsamplerate0 libsdl2-2.0-0 libsensors-config libsensors5 libshout3 libslirp0 libsndfile1 libsoup2.4-1 libsoup2.4-common libspeex1
  libspice-server1 libtag1v5 libtag1v5-vanilla libthai-data libthai0 libtheora0 libtiff5 libtpms0 libtwolame0 libunbound8 liburing2 libusbredirparser1 libv4l-0 libv4lconvert0
  libvirglrenderer1 libvirt-clients libvirt-daemon libvirt-daemon-config-network libvirt-daemon-config-nwfilter libvirt-daemon-driver-qemu libvirt-daemon-system
  libvirt-daemon-system-systemd libvirt0 libvisual-0.4-0 libvorbis0a libvorbisenc2 libvpx7 libvte-2.91-0 libvte-2.91-common libwavpack1 libwayland-client0 libwayland-cursor0
  libwayland-egl1 libwayland-server0 libwebp7 libwebpdemux2 libwebpmux3 libx11-xcb1 libxcb-dri2-0 libxcb-dri3-0 libxcb-glx0 libxcb-present0 libxcb-randr0 libxcb-render0 libxcb-shm0
  libxcb-sync1 libxcb-xfixes0 libxcomposite1 libxcursor1 libxdamage1 libxdp1 libxfixes3 libxi6 libxinerama1 libxkbcommon0 libxml2-utils libxrandr2 libxrender1 libxshmfence1 libxss1
  libxtst6 libxv1 libxxf86vm1 libyajl2 lsscsi mailcap mdevctl mime-support msr-tools nova-common nova-compute nova-compute-kvm nova-compute-libvirt nvme-cli os-brick-common ovmf
  pycadf-common python-pastedeploy-tpl python3-alembic python3-amqp python3-aniso8601 python3-anyjson python3-appdirs python3-asgiref python3-autopage python3-barbicanclient python3-bs4
  python3-cachetools python3-castellan python3-cffi python3-cinderclient python3-cliff python3-cmd2 python3-cursive python3-dateutil python3-ddt python3-debtcollector python3-decorator
  python3-defusedxml python3-deprecation python3-dnspython python3-docutils python3-dogpile.cache python3-elementpath python3-eventlet python3-extras python3-fasteners python3-fixtures
  python3-flask python3-flask-restful python3-futurist python3-glanceclient python3-greenlet python3-html5lib python3-importlib-resources python3-iso8601 python3-itsdangerous
  python3-jmespath python3-keystone python3-keystoneauth1 python3-keystoneclient python3-keystonemiddleware python3-kombu python3-ldap python3-libvirt python3-lxml python3-mako
  python3-memcache python3-microversion-parse python3-migrate python3-monotonic python3-msgpack python3-munch python3-nacl python3-netaddr python3-neutronclient python3-nova
  python3-novaclient python3-numpy python3-olefile python3-openstackclient python3-openstacksdk python3-openvswitch python3-os-brick python3-os-client-config python3-os-resource-classes
  python3-os-service-types python3-os-traits python3-os-vif python3-os-win python3-osc-lib python3-osc-placement python3-oslo.cache python3-oslo.concurrency python3-oslo.config
  python3-oslo.context python3-oslo.db python3-oslo.i18n python3-oslo.limit python3-oslo.log python3-oslo.messaging python3-oslo.metrics python3-oslo.middleware python3-oslo.policy
  python3-oslo.privsep python3-oslo.reports python3-oslo.rootwrap python3-oslo.serialization python3-oslo.service python3-oslo.upgradecheck python3-oslo.utils
  python3-oslo.versionedobjects python3-oslo.vmware python3-osprofiler python3-ovsdbapp python3-paramiko python3-passlib python3-paste python3-pastedeploy python3-pastescript python3-pbr
  python3-pil python3-platformdirs python3-ply python3-prettytable python3-prometheus-client python3-psutil python3-pycadf python3-pycparser python3-pygments python3-pyinotify
  python3-pymemcache python3-pymysql python3-pyperclip python3-pyroute2 python3-pysaml2 python3-repoze.lru python3-requestsexceptions python3-retrying python3-rfc3986 python3-roman
  python3-routes python3-scrypt python3-simplejson python3-sortedcontainers python3-soupsieve python3-sqlalchemy python3-sqlalchemy-ext python3-sqlparse python3-statsd python3-stevedore
  python3-suds python3-tempita python3-tenacity python3-testresources python3-testscenarios python3-testtools python3-tooz python3-typing-extensions python3-unittest2 python3-vine
  python3-voluptuous python3-warlock python3-wcwidth python3-webencodings python3-webob python3-websockify python3-werkzeug python3-wrapt python3-xmlschema python3-zvmcloudconnector
  qemu-block-extra qemu-system-common qemu-system-data qemu-system-gui qemu-system-x86 qemu-utils seabios session-migration sgml-base swtpm swtpm-tools systemd-container ubuntu-mono
  x11-common xml-core xmlsec1 zvmcloudconnector-common
The following packages will be upgraded:
  python3-blinker python3-click python3-jsonschema
3 upgraded, 401 newly installed, 0 to remove and 4 not upgraded.
Need to get 140 MB of archives.
After this operation, 611 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 bridge-utils amd64 1.7-1ubuntu3 [34.4 kB]
Get:2 http://ubuntu-cloud.archive.canonical.com/ubuntu jammy-updates/caracal/main amd64 nova-common all 3:29.0.1-0ubuntu1.4~cloud0 [105 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy/main amd64 ipxe-qemu all 1.21.1+git-20220113.fbbdc3926-0ubuntu1 [1569 kB]
Get:4 http://ubuntu-cloud.archive.canonical.com/ubuntu jammy-updates/caracal/main amd64 python3-sqlalchemy all 1.4.50+ds1-1build1~cloud0 [1026 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy/main amd64 ipxe-qemu-256k-compat-efi-roms all 1.0.0+git-20150424.a25a16d-0ubuntu4 [552 kB]
Get:6 http://archive.ubuntu.com/ubuntu jammy/main amd64 ebtables amd64 2.0.11-4build2 [84.9 kB] 
Get:7 http://archive.ubuntu.com/ubuntu jammy/main amd64 genisoimage amd64 9:1.1.11-3.2ubuntu1 [370 kB]
.
.
.
Setting up python3-osprofiler (3.4.3-3~cloud0) ...
Setting up python3-oslo.messaging (14.6.0-0ubuntu1~cloud0) ...
Setting up python3-neutronclient (1:11.2.0-0ubuntu1~cloud0) ...
Setting up python3-oslo.cache (3.7.0-0ubuntu1~cloud0) ...
Setting up python3-oslo.privsep (3.3.0-0ubuntu1~cloud0) ...
Setting up python3-castellan (5.0.0-0ubuntu1~cloud0) ...
Setting up python3-oslo.versionedobjects (3.3.0-0ubuntu1~cloud0) ...
Setting up python3-keystonemiddleware (10.6.0-0ubuntu1~cloud0) ...
Setting up python3-os-win (5.9.0-0ubuntu1~cloud0) ...
Setting up python3-os-brick (6.7.0-0ubuntu1~cloud0) ...
Setting up python3-os-vif (3.5.0-0ubuntu1~cloud0) ...
Setting up python3-keystone (2:25.0.0-0ubuntu1~cloud0) ...
Setting up python3-cursive (0.2.2-4) ...
Setting up python3-nova (3:29.0.1-0ubuntu1.4~cloud0) ...
Setting up nova-compute-libvirt (3:29.0.1-0ubuntu1.4~cloud0) ...
Adding user `nova' to group `libvirt' ...
Adding user nova to group libvirt
Done.
Adding user `libvirt-qemu' to group `nova' ...
Adding user libvirt-qemu to group nova
Done.
Setting up nova-compute-kvm (3:29.0.1-0ubuntu1.4~cloud0) ...
Adding user `nova' to group `kvm' ...
Adding user nova to group kvm
Done.
Setting up nova-compute (3:29.0.1-0ubuntu1.4~cloud0) ...
Created symlink /etc/systemd/system/multi-user.target.wants/nova-compute.service → /lib/systemd/system/nova-compute.service.
Processing triggers for libgdk-pixbuf-2.0-0:amd64 (2.42.8+dfsg-1ubuntu0.3) ...
Processing triggers for libc-bin (2.35-0ubuntu3.9) ...
Scanning processes...                                                                                                                                                                        
Scanning linux images...                                                                                                                                                                     

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```

# SQL Database
### Controller Node
1. Install the packages:
```shell
apt install mariadb-server python3-pymysql
```
```shell
root@controller:~# apt install mariadb-server python3-pymysql
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3-pymysql is already the newest version (1.0.2-1ubuntu1.22.04.1).
python3-pymysql set to manually installed.
The following additional packages will be installed:
  galera-4 libcgi-fast-perl libcgi-pm-perl libclone-perl libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl libencode-locale-perl libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl libhttp-date-perl libhttp-message-perl libio-html-perl liblwp-mediatypes-perl libmariadb3 libmysqlclient21 libsnappy1v5
  libtimedate-perl liburi-perl mariadb-client-10.6 mariadb-client-core-10.6 mariadb-common mariadb-server-10.6 mariadb-server-core-10.6 mysql-common socat
Suggested packages:
  libmldbm-perl libnet-daemon-perl libsql-statement-perl libdata-dump-perl libipc-sharedcache-perl libbusiness-isbn-perl libwww-perl mailx mariadb-test
The following NEW packages will be installed:
  galera-4 libcgi-fast-perl libcgi-pm-perl libclone-perl libconfig-inifiles-perl libdbd-mysql-perl libdbi-perl libencode-locale-perl libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl libhttp-date-perl libhttp-message-perl libio-html-perl liblwp-mediatypes-perl libmariadb3 libmysqlclient21 libsnappy1v5
  libtimedate-perl liburi-perl mariadb-client-10.6 mariadb-client-core-10.6 mariadb-common mariadb-server mariadb-server-10.6 mariadb-server-core-10.6 mysql-common socat
0 upgraded, 31 newly installed, 0 to remove and 4 not upgraded.
Need to get 18.6 MB of archives.
After this operation, 164 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 mysql-common all 5.8+1.0.8 [7212 B]
Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-common all 1:10.6.18-0ubuntu0.22.04.1 [16.5 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy/universe amd64 galera-4 amd64 26.4.9-1build1 [720 kB]
Get:4 http://archive.ubuntu.com/ubuntu jammy/main amd64 libdbi-perl amd64 1.643-3build3 [741 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy/main amd64 libconfig-inifiles-perl all 3.000003-1 [40.5 kB]
Get:6 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 libmariadb3 amd64 1:10.6.18-0ubuntu0.22.04.1 [181 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-client-core-10.6 amd64 1:10.6.18-0ubuntu0.22.04.1 [974 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-client-10.6 amd64 1:10.6.18-0ubuntu0.22.04.1 [1523 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 libsnappy1v5 amd64 1.1.8-1build3 [17.5 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-server-core-10.6 amd64 1:10.6.18-0ubuntu0.22.04.1 [7694 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy/main amd64 socat amd64 1.7.4.1-3ubuntu4 [349 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-server-10.6 amd64 1:10.6.18-0ubuntu0.22.04.1 [4222 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy/main amd64 libhtml-tagset-perl all 3.20-4 [12.5 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy/main amd64 liburi-perl all 5.10-1 [78.8 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy/main amd64 libhtml-parser-perl amd64 3.76-1build2 [88.4 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy/main amd64 libcgi-pm-perl all 4.54-1 [188 kB]
Get:17 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfcgi0ldbl amd64 2.4.2-2build2 [28.0 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfcgi-perl amd64 0.82+ds-1build1 [22.8 kB]
Get:19 http://archive.ubuntu.com/ubuntu jammy/main amd64 libcgi-fast-perl all 1:2.15-1 [10.5 kB]
Get:20 http://archive.ubuntu.com/ubuntu jammy/main amd64 libclone-perl amd64 0.45-1build3 [11.0 kB]
Get:21 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 libmysqlclient21 amd64 8.0.41-0ubuntu0.22.04.1 [1308 kB]
Get:22 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 libdbd-mysql-perl amd64 4.050-5ubuntu0.22.04.1 [87.6 kB]
Get:23 http://archive.ubuntu.com/ubuntu jammy/main amd64 libencode-locale-perl all 1.05-1.1 [11.8 kB]
Get:24 http://archive.ubuntu.com/ubuntu jammy/main amd64 libfcgi-bin amd64 2.4.2-2build2 [11.2 kB]
Get:25 http://archive.ubuntu.com/ubuntu jammy/main amd64 libhtml-template-perl all 2.97-1.1 [59.1 kB]
Get:26 http://archive.ubuntu.com/ubuntu jammy/main amd64 libtimedate-perl all 2.3300-2 [34.0 kB]
Get:27 http://archive.ubuntu.com/ubuntu jammy/main amd64 libhttp-date-perl all 6.05-1 [9920 B]
Get:28 http://archive.ubuntu.com/ubuntu jammy/main amd64 libio-html-perl all 1.004-2 [15.4 kB]
Get:29 http://archive.ubuntu.com/ubuntu jammy/main amd64 liblwp-mediatypes-perl all 6.04-1 [19.5 kB]
Get:30 http://archive.ubuntu.com/ubuntu jammy/main amd64 libhttp-message-perl all 6.36-1 [76.8 kB]
Get:31 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 mariadb-server all 1:10.6.18-0ubuntu0.22.04.1 [11.8 kB]
Fetched 18.6 MB in 4s (4893 kB/s)         
Extracting templates from packages: 100%
Preconfiguring packages ...
Selecting previously unselected package mysql-common.
(Reading database ... 125257 files and directories currently installed.)
Preparing to unpack .../00-mysql-common_5.8+1.0.8_all.deb ...
Unpacking mysql-common (5.8+1.0.8) ...
Selecting previously unselected package mariadb-common.
Preparing to unpack .../01-mariadb-common_1%3a10.6.18-0ubuntu0.22.04.1_all.deb ...
Unpacking mariadb-common (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package galera-4.
Preparing to unpack .../02-galera-4_26.4.9-1build1_amd64.deb ...
Unpacking galera-4 (26.4.9-1build1) ...
Selecting previously unselected package libdbi-perl:amd64.
Preparing to unpack .../03-libdbi-perl_1.643-3build3_amd64.deb ...
Unpacking libdbi-perl:amd64 (1.643-3build3) ...
Selecting previously unselected package libconfig-inifiles-perl.
Preparing to unpack .../04-libconfig-inifiles-perl_3.000003-1_all.deb ...
Unpacking libconfig-inifiles-perl (3.000003-1) ...
Selecting previously unselected package libmariadb3:amd64.
Preparing to unpack .../05-libmariadb3_1%3a10.6.18-0ubuntu0.22.04.1_amd64.deb ...
Unpacking libmariadb3:amd64 (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package mariadb-client-core-10.6.
Preparing to unpack .../06-mariadb-client-core-10.6_1%3a10.6.18-0ubuntu0.22.04.1_amd64.deb ...
Unpacking mariadb-client-core-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package mariadb-client-10.6.
Preparing to unpack .../07-mariadb-client-10.6_1%3a10.6.18-0ubuntu0.22.04.1_amd64.deb ...
Unpacking mariadb-client-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package libsnappy1v5:amd64.
Preparing to unpack .../08-libsnappy1v5_1.1.8-1build3_amd64.deb ...
Unpacking libsnappy1v5:amd64 (1.1.8-1build3) ...
Selecting previously unselected package mariadb-server-core-10.6.
Preparing to unpack .../09-mariadb-server-core-10.6_1%3a10.6.18-0ubuntu0.22.04.1_amd64.deb ...
Unpacking mariadb-server-core-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package socat.
Preparing to unpack .../10-socat_1.7.4.1-3ubuntu4_amd64.deb ...
Unpacking socat (1.7.4.1-3ubuntu4) ...
Setting up mysql-common (5.8+1.0.8) ...
update-alternatives: using /etc/mysql/my.cnf.fallback to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Setting up mariadb-common (1:10.6.18-0ubuntu0.22.04.1) ...
update-alternatives: using /etc/mysql/mariadb.cnf to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Selecting previously unselected package mariadb-server-10.6.
(Reading database ... 125695 files and directories currently installed.)
Preparing to unpack .../00-mariadb-server-10.6_1%3a10.6.18-0ubuntu0.22.04.1_amd64.deb ...
Unpacking mariadb-server-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Selecting previously unselected package libhtml-tagset-perl.
Preparing to unpack .../01-libhtml-tagset-perl_3.20-4_all.deb ...
Unpacking libhtml-tagset-perl (3.20-4) ...
Selecting previously unselected package liburi-perl.
Preparing to unpack .../02-liburi-perl_5.10-1_all.deb ...
Unpacking liburi-perl (5.10-1) ...
Selecting previously unselected package libhtml-parser-perl:amd64.
Preparing to unpack .../03-libhtml-parser-perl_3.76-1build2_amd64.deb ...
Unpacking libhtml-parser-perl:amd64 (3.76-1build2) ...
Selecting previously unselected package libcgi-pm-perl.
Preparing to unpack .../04-libcgi-pm-perl_4.54-1_all.deb ...
Unpacking libcgi-pm-perl (4.54-1) ...
Selecting previously unselected package libfcgi0ldbl:amd64.
Preparing to unpack .../05-libfcgi0ldbl_2.4.2-2build2_amd64.deb ...
Unpacking libfcgi0ldbl:amd64 (2.4.2-2build2) ...
Selecting previously unselected package libfcgi-perl:amd64.
Preparing to unpack .../06-libfcgi-perl_0.82+ds-1build1_amd64.deb ...
Unpacking libfcgi-perl:amd64 (0.82+ds-1build1) ...
Selecting previously unselected package libcgi-fast-perl.
Preparing to unpack .../07-libcgi-fast-perl_1%3a2.15-1_all.deb ...
Unpacking libcgi-fast-perl (1:2.15-1) ...
Selecting previously unselected package libclone-perl.
Preparing to unpack .../08-libclone-perl_0.45-1build3_amd64.deb ...
Unpacking libclone-perl (0.45-1build3) ...
Selecting previously unselected package libmysqlclient21:amd64.
Preparing to unpack .../09-libmysqlclient21_8.0.41-0ubuntu0.22.04.1_amd64.deb ...
Unpacking libmysqlclient21:amd64 (8.0.41-0ubuntu0.22.04.1) ...
Selecting previously unselected package libdbd-mysql-perl:amd64.
Preparing to unpack .../10-libdbd-mysql-perl_4.050-5ubuntu0.22.04.1_amd64.deb ...
Unpacking libdbd-mysql-perl:amd64 (4.050-5ubuntu0.22.04.1) ...
Selecting previously unselected package libencode-locale-perl.
Preparing to unpack .../11-libencode-locale-perl_1.05-1.1_all.deb ...
Unpacking libencode-locale-perl (1.05-1.1) ...
Selecting previously unselected package libfcgi-bin.
Preparing to unpack .../12-libfcgi-bin_2.4.2-2build2_amd64.deb ...
Unpacking libfcgi-bin (2.4.2-2build2) ...
Selecting previously unselected package libhtml-template-perl.
Preparing to unpack .../13-libhtml-template-perl_2.97-1.1_all.deb ...
Unpacking libhtml-template-perl (2.97-1.1) ...
Selecting previously unselected package libtimedate-perl.
Preparing to unpack .../14-libtimedate-perl_2.3300-2_all.deb ...
Unpacking libtimedate-perl (2.3300-2) ...
Selecting previously unselected package libhttp-date-perl.
Preparing to unpack .../15-libhttp-date-perl_6.05-1_all.deb ...
Unpacking libhttp-date-perl (6.05-1) ...
Selecting previously unselected package libio-html-perl.
Preparing to unpack .../16-libio-html-perl_1.004-2_all.deb ...
Unpacking libio-html-perl (1.004-2) ...
Selecting previously unselected package liblwp-mediatypes-perl.
Preparing to unpack .../17-liblwp-mediatypes-perl_6.04-1_all.deb ...
Unpacking liblwp-mediatypes-perl (6.04-1) ...
Selecting previously unselected package libhttp-message-perl.
Preparing to unpack .../18-libhttp-message-perl_6.36-1_all.deb ...
Unpacking libhttp-message-perl (6.36-1) ...
Selecting previously unselected package mariadb-server.
Preparing to unpack .../19-mariadb-server_1%3a10.6.18-0ubuntu0.22.04.1_all.deb ...
Unpacking mariadb-server (1:10.6.18-0ubuntu0.22.04.1) ...
Setting up libconfig-inifiles-perl (3.000003-1) ...
Setting up galera-4 (26.4.9-1build1) ...
Setting up libmysqlclient21:amd64 (8.0.41-0ubuntu0.22.04.1) ...
Setting up libfcgi0ldbl:amd64 (2.4.2-2build2) ...
Setting up libclone-perl (0.45-1build3) ...
Setting up libhtml-tagset-perl (3.20-4) ...
Setting up liblwp-mediatypes-perl (6.04-1) ...
Setting up libfcgi-bin (2.4.2-2build2) ...
Setting up libencode-locale-perl (1.05-1.1) ...
Setting up libsnappy1v5:amd64 (1.1.8-1build3) ...
Setting up socat (1.7.4.1-3ubuntu4) ...
Setting up libio-html-perl (1.004-2) ...
Setting up libmariadb3:amd64 (1:10.6.18-0ubuntu0.22.04.1) ...
Setting up libtimedate-perl (2.3300-2) ...
Setting up libfcgi-perl:amd64 (0.82+ds-1build1) ...
Setting up liburi-perl (5.10-1) ...
Setting up libdbi-perl:amd64 (1.643-3build3) ...
Setting up mariadb-server-core-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Setting up libhttp-date-perl (6.05-1) ...
Setting up mariadb-client-core-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Setting up libdbd-mysql-perl:amd64 (4.050-5ubuntu0.22.04.1) ...
Setting up libhtml-parser-perl:amd64 (3.76-1build2) ...
Setting up mariadb-client-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Setting up libhttp-message-perl (6.36-1) ...
Setting up libcgi-pm-perl (4.54-1) ...
Setting up libhtml-template-perl (2.97-1.1) ...
Setting up mariadb-server-10.6 (1:10.6.18-0ubuntu0.22.04.1) ...
Created symlink /etc/systemd/system/multi-user.target.wants/mariadb.service → /lib/systemd/system/mariadb.service.
Setting up libcgi-fast-perl (1:2.15-1) ...
Setting up mariadb-server (1:10.6.18-0ubuntu0.22.04.1) ...
Processing triggers for man-db (2.10.2-1) ...
Processing triggers for libc-bin (2.35-0ubuntu3.9) ...
Scanning processes...                                                                                                                                                                        
Scanning linux images...                                                                                                                                                                     

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
2. Create and edit the /etc/mysql/mariadb.conf.d/99-openstack.cnf file and complete the following actions:
```shell
vi /etc/mysql/mariadb.conf.d/99-openstack.cnf
```
```shell
[mysqld]
bind-address = 10.0.0.11

default-storage-engine = innodb
innodb_file_per_table = on
max_connections = 4096
collation-server = utf8_general_ci
character-set-server = utf8
```
3. Restart the database service:
```shell
systemctl enable mysql
systemctl restart mysql
```
```shell
root@controller:~# systemctl enable mysql
root@controller:~# systemctl restart mysql
```
4. Secure the database service by running the **mysql_secure_installation** script. In particular, choose a suitable password for the database **root** account:
```shell
mysql_secure_installation
```
```shell
root@controller:~# mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we'll need the current
password for the root user. If you've just installed MariaDB, and
haven't set the root password yet, you should just press enter here.

Enter current password for root (enter for none): 
OK, successfully used password, moving on...

Setting the root password or using the unix_socket ensures that nobody
can log into the MariaDB root user without the proper authorisation.

You already have your root account protected, so you can safely answer 'n'.

Switch to unix_socket authentication [Y/n] n
 ... skipping.

You already have your root account protected, so you can safely answer 'n'.

Change the root password? [Y/n] y
New password: 
Re-enter new password: 
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] y
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] n
 ... skipping.

By default, MariaDB comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] y
 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] y
 ... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
```

# Message queue
### Controller Node
1. Install the package:
```shell
apt install -y rabbitmq-server
```
```shell
root@controller:~# apt install -y rabbitmq-server
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  erlang-asn1 erlang-base erlang-crypto erlang-eldap erlang-ftp erlang-inets erlang-mnesia erlang-os-mon erlang-parsetools erlang-public-key erlang-runtime-tools erlang-snmp erlang-ssl
  erlang-syntax-tools erlang-tftp erlang-tools erlang-xmerl libsctp1
Suggested packages:
  erlang erlang-manpages erlang-doc lksctp-tools
The following NEW packages will be installed:
  erlang-asn1 erlang-base erlang-crypto erlang-eldap erlang-ftp erlang-inets erlang-mnesia erlang-os-mon erlang-parsetools erlang-public-key erlang-runtime-tools erlang-snmp erlang-ssl
  erlang-syntax-tools erlang-tftp erlang-tools erlang-xmerl libsctp1 rabbitmq-server
0 upgraded, 19 newly installed, 0 to remove and 4 not upgraded.
Need to get 35.1 MB of archives.
After this operation, 54.8 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-base amd64 1:24.2.1+dfsg-1ubuntu0.1 [9829 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-asn1 amd64 1:24.2.1+dfsg-1ubuntu0.1 [911 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-crypto amd64 1:24.2.1+dfsg-1ubuntu0.1 [157 kB]
Get:4 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-public-key amd64 1:24.2.1+dfsg-1ubuntu0.1 [784 kB]
Get:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-mnesia amd64 1:24.2.1+dfsg-1ubuntu0.1 [891 kB]
Get:6 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-runtime-tools amd64 1:24.2.1+dfsg-1ubuntu0.1 [227 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-ssl amd64 1:24.2.1+dfsg-1ubuntu0.1 [1585 kB]
Get:8 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-eldap amd64 1:24.2.1+dfsg-1ubuntu0.1 [125 kB]
Get:9 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-ftp amd64 1:24.2.1+dfsg-1ubuntu0.1 [84.4 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-tftp amd64 1:24.2.1+dfsg-1ubuntu0.1 [103 kB]
Get:11 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-inets amd64 1:24.2.1+dfsg-1ubuntu0.1 [627 kB]
Get:12 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-snmp amd64 1:24.2.1+dfsg-1ubuntu0.1 [1894 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-os-mon amd64 1:24.2.1+dfsg-1ubuntu0.1 [91.1 kB]
Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-parsetools amd64 1:24.2.1+dfsg-1ubuntu0.1 [194 kB]
Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-syntax-tools amd64 1:24.2.1+dfsg-1ubuntu0.1 [303 kB]
Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-tools amd64 1:24.2.1+dfsg-1ubuntu0.1 [635 kB]
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 erlang-xmerl amd64 1:24.2.1+dfsg-1ubuntu0.1 [1383 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy/main amd64 libsctp1 amd64 1.0.19+dfsg-1build1 [9370 B]
Get:19 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 rabbitmq-server all 3.9.27-0ubuntu0.1 [15.2 MB]
Fetched 35.1 MB in 5s (7066 kB/s)           
Selecting previously unselected package erlang-base.
(Reading database ... 126148 files and directories currently installed.)
Preparing to unpack .../00-erlang-base_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-base (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-asn1.
Preparing to unpack .../01-erlang-asn1_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-asn1 (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-crypto.
Preparing to unpack .../02-erlang-crypto_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-crypto (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-public-key.
Preparing to unpack .../03-erlang-public-key_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-public-key (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-mnesia.
Preparing to unpack .../04-erlang-mnesia_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-mnesia (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-runtime-tools.
Preparing to unpack .../05-erlang-runtime-tools_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-runtime-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-ssl.
Preparing to unpack .../06-erlang-ssl_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-ssl (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-eldap.
Preparing to unpack .../07-erlang-eldap_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-eldap (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-ftp.
Preparing to unpack .../08-erlang-ftp_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-ftp (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-tftp.
Preparing to unpack .../09-erlang-tftp_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-tftp (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-inets.
Preparing to unpack .../10-erlang-inets_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-inets (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-snmp.
Preparing to unpack .../11-erlang-snmp_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-snmp (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-os-mon.
Preparing to unpack .../12-erlang-os-mon_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-os-mon (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-parsetools.
Preparing to unpack .../13-erlang-parsetools_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-parsetools (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-syntax-tools.
Preparing to unpack .../14-erlang-syntax-tools_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-syntax-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-tools.
Preparing to unpack .../15-erlang-tools_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package erlang-xmerl.
Preparing to unpack .../16-erlang-xmerl_1%3a24.2.1+dfsg-1ubuntu0.1_amd64.deb ...
Unpacking erlang-xmerl (1:24.2.1+dfsg-1ubuntu0.1) ...
Selecting previously unselected package libsctp1:amd64.
Preparing to unpack .../17-libsctp1_1.0.19+dfsg-1build1_amd64.deb ...
Unpacking libsctp1:amd64 (1.0.19+dfsg-1build1) ...
Selecting previously unselected package rabbitmq-server.
Preparing to unpack .../18-rabbitmq-server_3.9.27-0ubuntu0.1_all.deb ...
Unpacking rabbitmq-server (3.9.27-0ubuntu0.1) ...
Setting up erlang-base (1:24.2.1+dfsg-1ubuntu0.1) ...
Searching for services which depend on erlang and should be started... none found.
Setting up erlang-xmerl (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-syntax-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-parsetools (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-asn1 (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-tftp (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up libsctp1:amd64 (1.0.19+dfsg-1build1) ...
Setting up erlang-mnesia (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-crypto (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-runtime-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-tools (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-snmp (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-public-key (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-ssl (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-os-mon (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-eldap (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-ftp (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up erlang-inets (1:24.2.1+dfsg-1ubuntu0.1) ...
Setting up rabbitmq-server (3.9.27-0ubuntu0.1) ...
Adding group `rabbitmq' (GID 130) ...
Done.
Adding system user `rabbitmq' (UID 121) ...
Adding new user `rabbitmq' (UID 121) with group `rabbitmq' ...
Not creating home directory `/var/lib/rabbitmq'.
Created symlink /etc/systemd/system/multi-user.target.wants/rabbitmq-server.service → /lib/systemd/system/rabbitmq-server.service.
Processing triggers for man-db (2.10.2-1) ...
Processing triggers for libc-bin (2.35-0ubuntu3.9) ...
Scanning processes...                                                                                                                                                                        
Scanning linux images...                                                                                                                                                                     

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
2. Add the openstack user:
```shell
rabbitmqctl add_user openstack Passw0rd
```
```shell
root@controller:~# rabbitmqctl add_user openstack Passw0rd
Adding user "openstack" ...
Done. Don't forget to grant the user permissions to some virtual hosts! See 'rabbitmqctl help set_permissions' to learn more.
```
3. Permit configuration, write, and read access for the openstack user:
```shell
rabbitmqctl set_permissions openstack ".*" ".*" ".*"
```
```shell
root@controller:~# rabbitmqctl set_permissions openstack ".*" ".*" ".*"
Setting permissions for user "openstack" in vhost "/" ...
```

# Memcached
### Controller Node
1. Install the packages:
```shell
apt install -y memcached python3-memcache
```
```shell
root@controller:~# apt install -y memcached python3-memcache
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3-memcache is already the newest version (1.59-5).
python3-memcache set to manually installed.
Suggested packages:
  libanyevent-perl libcache-memcached-perl libmemcached libyaml-perl
The following NEW packages will be installed:
  memcached
0 upgraded, 1 newly installed, 0 to remove and 4 not upgraded.
Need to get 210 kB of archives.
After this operation, 609 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 memcached amd64 1.6.14-1ubuntu0.1 [210 kB]
Fetched 210 kB in 1s (158 kB/s)     
Selecting previously unselected package memcached.
(Reading database ... 128941 files and directories currently installed.)
Preparing to unpack .../memcached_1.6.14-1ubuntu0.1_amd64.deb ...
Unpacking memcached (1.6.14-1ubuntu0.1) ...
Setting up memcached (1.6.14-1ubuntu0.1) ...
Created symlink /etc/systemd/system/multi-user.target.wants/memcached.service → /lib/systemd/system/memcached.service.
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...                                                                                                                                                                        
Scanning linux images...                                                                                                                                                                     

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
2. Edit the **/etc/memcached.conf** file and configure the service to use the management IP address of the controller node. This is to enable access by other nodes via the management network:
```shell
vi /etc/memcached.conf
```
```shell
-d
logfile /var/log/memcached.log
-m 64
-p 11211
-u memcache
-l 10.0.0.11
-P /var/run/memcached/memcached.pid
```
3. Restart the Memcached service:
```shell
systemctl enable memcached
systemctl restart memcached
```
```shell
root@controller:~# systemctl enable memcached
Synchronizing state of memcached.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable memcached
root@controller:~# systemctl restart memcached
```

# ETCD
### Controller Node
1. Install the **etcd** package:
```shell
apt install -y etcd-server
```
```shell
root@controller:~# apt install -y etcd
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  etcd-client etcd-server pipexec
The following NEW packages will be installed:
  etcd etcd-client etcd-server pipexec
0 upgraded, 4 newly installed, 0 to remove and 4 not upgraded.
Need to get 10.5 MB of archives.
After this operation, 34.9 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/universe amd64 pipexec amd64 2.5.5-2 [17.5 kB]
Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 etcd-server amd64 3.3.25+dfsg-7ubuntu0.22.04.2 [5882 kB]
Get:3 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 etcd-client amd64 3.3.25+dfsg-7ubuntu0.22.04.2 [4585 kB]
Get:4 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 etcd all 3.3.25+dfsg-7ubuntu0.22.04.2 [9510 B]
Fetched 10.5 MB in 3s (3010 kB/s)
Selecting previously unselected package pipexec.
(Reading database ... 128973 files and directories currently installed.)
Preparing to unpack .../pipexec_2.5.5-2_amd64.deb ...
Unpacking pipexec (2.5.5-2) ...
Selecting previously unselected package etcd-server.
Preparing to unpack .../etcd-server_3.3.25+dfsg-7ubuntu0.22.04.2_amd64.deb ...
Unpacking etcd-server (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Selecting previously unselected package etcd-client.
Preparing to unpack .../etcd-client_3.3.25+dfsg-7ubuntu0.22.04.2_amd64.deb ...
Unpacking etcd-client (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Selecting previously unselected package etcd.
Preparing to unpack .../etcd_3.3.25+dfsg-7ubuntu0.22.04.2_all.deb ...
Unpacking etcd (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Setting up pipexec (2.5.5-2) ...
Setting up etcd-client (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Setting up etcd-server (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Adding system user `etcd' (UID 123) ...
Adding new group `etcd' (GID 132) ...
Adding new user `etcd' (UID 123) with group `etcd' ...
Creating home directory `/var/lib/etcd/' ...
Created symlink /etc/systemd/system/etcd2.service → /lib/systemd/system/etcd.service.
Created symlink /etc/systemd/system/multi-user.target.wants/etcd.service → /lib/systemd/system/etcd.service.
Setting up etcd (3.3.25+dfsg-7ubuntu0.22.04.2) ...
Processing triggers for man-db (2.10.2-1) ...
Scanning processes...                                                                                                                                                                        
Scanning linux images...                                                                                                                                                                     

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
2. Edit the **/etc/default/etcd** file and set the **ETCD_INITIAL_CLUSTER, ETCD_INITIAL_ADVERTISE_PEER_URLS, ETCD_ADVERTISE_CLIENT_URLS, ETCD_LISTEN_CLIENT_URLS** to the management IP address of the controller node to enable access by other nodes via the management network:
```shell
vi /etc/default/etcd
```
```shell
ETCD_NAME="controller"
ETCD_DATA_DIR="/var/lib/etcd"
ETCD_INITIAL_CLUSTER_STATE="new"
ETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster-01"
ETCD_INITIAL_CLUSTER="controller=http://10.0.0.11:2380"
ETCD_INITIAL_ADVERTISE_PEER_URLS="http://10.0.0.11:2380"
ETCD_ADVERTISE_CLIENT_URLS="http://10.0.0.11:2379"
ETCD_LISTEN_PEER_URLS="http://0.0.0.0:2380"
ETCD_LISTEN_CLIENT_URLS="http://10.0.0.11:2379"
```
3. Enable and restart the etcd service:
```shell
systemctl enable etcd
systemctl restart etcd
```
```shell
root@controller:~# systemctl enable etcd
Synchronizing state of etcd.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable etcd
root@controller:~# systemctl restart etcd
```
